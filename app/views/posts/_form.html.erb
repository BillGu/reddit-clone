<%= form_with model: post, local: true do |form| %>
    <div>
        <%= label :post, :title %>
        <%= form.text_field :title, minlength: MIN_POST, maxlength: MAX_POST, required: true %>
    </div>

    <div>
        <%= label :post, :url %>
        <%= form.text_field :url %>
    </div>

    <div>
        <%= label :post, :content %>
        <%= form.text_area :content %>
    </div>

    <div>
        <label>Select 1-3 subs to post in:</label>

        <input list="sub-options" id="sub-choices">
        <datalist id="sub-options">
            <% subs.each do |sub| %>
                <option data-subid="sub_<%= sub.id %>" value="<%= sub.title %>">
            <% end %>
        </datalist>


        <input type="hidden" name="post[sub_ids][]" value="">
        <% subs.each do |sub| %>
            <% checked = params[:sub_id].to_i == sub.id || post.subs.include?(sub) %>
            <input type="checkbox" id="sub_<%=sub.id%>" name="post[sub_ids][]" value="<%= sub.id %>"
                <%= "checked" if checked %> >
            <label for="sub_<%=sub.id%>"><%= sub.title %></label>
        <% end %>
    </div>

    <div>
        <%= form.submit "Save" %>
    </div>
<% end %>


<%= javascript_include_tag 'components/post_form' %>